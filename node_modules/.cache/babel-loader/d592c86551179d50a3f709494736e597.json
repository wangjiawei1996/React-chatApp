{"ast":null,"code":"import _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n/* tslint:disable:jsx-no-multiline-js */\n\n\nimport classnames from 'classnames';\nimport React from 'react';\nimport TouchFeedback from 'rmc-feedback';\nimport Carousel from '../carousel';\nimport Flex from '../flex';\n\nvar Grid = function (_React$Component) {\n  _inherits(Grid, _React$Component);\n\n  function Grid() {\n    _classCallCheck(this, Grid);\n\n    var _this = _possibleConstructorReturn(this, (Grid.__proto__ || Object.getPrototypeOf(Grid)).apply(this, arguments));\n\n    _this.state = {\n      initialSlideWidth: 0\n    };\n\n    _this.renderCarousel = function (rowsArr, pageCount, rowCount) {\n      var prefixCls = _this.props.prefixCls;\n      var carouselMaxRow = _this.props.carouselMaxRow;\n      var pagesArr = [];\n\n      for (var pageIndex = 0; pageIndex < pageCount; pageIndex++) {\n        var pageRows = [];\n\n        for (var ii = 0; ii < carouselMaxRow; ii++) {\n          var rowIndex = pageIndex * carouselMaxRow + ii;\n\n          if (rowIndex < rowCount) {\n            pageRows.push(rowsArr[rowIndex]);\n          } else {\n            // 空节点为了确保末尾页的最后未到底的行有底线(样式中last-child会没线)\n            pageRows.push(React.createElement('div', {\n              key: 'gridline-' + rowIndex\n            }));\n          }\n        }\n\n        pagesArr.push(React.createElement('div', {\n          key: 'pageitem-' + pageIndex,\n          className: prefixCls + '-carousel-page'\n        }, pageRows));\n      }\n\n      return pagesArr;\n    };\n\n    _this.renderItem = function (dataItem, index, columnNum, renderItem) {\n      var prefixCls = _this.props.prefixCls;\n      var itemEl = null;\n\n      if (renderItem) {\n        itemEl = renderItem(dataItem, index);\n      } else {\n        if (dataItem) {\n          var icon = dataItem.icon,\n              text = dataItem.text;\n          itemEl = React.createElement('div', {\n            className: prefixCls + '-item-inner-content column-num-' + columnNum\n          }, React.isValidElement(icon) ? icon : React.createElement('img', {\n            className: prefixCls + '-icon',\n            src: icon\n          }), React.createElement('div', {\n            className: prefixCls + '-text'\n          }, text));\n        }\n      }\n\n      return React.createElement('div', {\n        className: prefixCls + '-item-content'\n      }, itemEl);\n    };\n\n    _this.getRows = function (rowCount, dataLength) {\n      // tslint:disable:prefer-const\n      var _this$props = _this.props,\n          columnNum = _this$props.columnNum,\n          data = _this$props.data,\n          renderItem = _this$props.renderItem,\n          prefixCls = _this$props.prefixCls,\n          _onClick = _this$props.onClick,\n          activeStyle = _this$props.activeStyle,\n          activeClassName = _this$props.activeClassName,\n          itemStyle = _this$props.itemStyle;\n      var rowsArr = [];\n      columnNum = columnNum;\n      var rowWidth = 100 / columnNum + '%';\n\n      var colStyle = _extends({\n        width: rowWidth\n      }, itemStyle);\n\n      for (var i = 0; i < rowCount; i++) {\n        var rowArr = [];\n\n        var _loop = function _loop(j) {\n          var dataIndex = i * columnNum + j;\n          var itemEl = void 0;\n\n          if (dataIndex < dataLength) {\n            var el = data && data[dataIndex];\n            itemEl = React.createElement(TouchFeedback, {\n              key: 'griditem-' + dataIndex,\n              activeClassName: activeClassName ? activeClassName : prefixCls + '-item-active',\n              activeStyle: activeStyle\n            }, React.createElement(Flex.Item, {\n              className: prefixCls + '-item',\n              onClick: function onClick() {\n                return _onClick && _onClick(el, dataIndex);\n              },\n              style: colStyle\n            }, _this.renderItem(el, dataIndex, columnNum, renderItem)));\n          } else {\n            itemEl = React.createElement(Flex.Item, {\n              key: 'griditem-' + dataIndex,\n              className: prefixCls + '-item ' + prefixCls + '-null-item',\n              style: colStyle\n            });\n          }\n\n          rowArr.push(itemEl);\n        };\n\n        for (var j = 0; j < columnNum; j++) {\n          _loop(j);\n        }\n\n        rowsArr.push(React.createElement(Flex, {\n          justify: 'center',\n          align: 'stretch',\n          key: 'gridline-' + i\n        }, rowArr));\n      }\n\n      return rowsArr;\n    };\n\n    return _this;\n  }\n\n  _createClass(Grid, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.setState({\n        initialSlideWidth: document.documentElement.clientWidth\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _classnames;\n\n      var _a = this.props,\n          prefixCls = _a.prefixCls,\n          className = _a.className,\n          data = _a.data,\n          hasLine = _a.hasLine,\n          isCarousel = _a.isCarousel,\n          square = _a.square,\n          activeStyle = _a.activeStyle,\n          activeClassName = _a.activeClassName,\n          restProps = __rest(_a, [\"prefixCls\", \"className\", \"data\", \"hasLine\", \"isCarousel\", \"square\", \"activeStyle\", \"activeClassName\"]);\n\n      var columnNum = restProps.columnNum,\n          carouselMaxRow = restProps.carouselMaxRow,\n          onClick = restProps.onClick,\n          renderItem = restProps.renderItem,\n          restPropsForCarousel = __rest(restProps, [\"columnNum\", \"carouselMaxRow\", \"onClick\", \"renderItem\"]);\n\n      var initialSlideWidth = this.state.initialSlideWidth;\n      columnNum = columnNum;\n      carouselMaxRow = carouselMaxRow;\n      var dataLength = data && data.length || 0;\n      var rowCount = Math.ceil(dataLength / columnNum);\n      var rowsArr = void 0;\n      var renderEl = void 0;\n\n      if (isCarousel) {\n        if (initialSlideWidth < 0) {\n          // carousel  server render. because carousel dependes on document\n          return null;\n        }\n\n        if (rowCount % carouselMaxRow !== 0) {\n          rowCount = rowCount + carouselMaxRow - rowCount % carouselMaxRow;\n        }\n\n        var pageCount = Math.ceil(rowCount / carouselMaxRow);\n        rowsArr = this.getRows(rowCount, dataLength);\n        var carouselProps = {};\n\n        if (pageCount <= 1) {\n          carouselProps = {\n            dots: false,\n            dragging: false,\n            swiping: false\n          };\n        }\n\n        renderEl = React.createElement(Carousel, _extends({\n          initialSlideWidth: initialSlideWidth\n        }, restPropsForCarousel, carouselProps), this.renderCarousel(rowsArr, pageCount, rowCount));\n      } else {\n        rowsArr = this.getRows(rowCount, dataLength);\n        renderEl = rowsArr;\n      }\n\n      var cls = classnames(prefixCls, className, (_classnames = {}, _defineProperty(_classnames, prefixCls + '-square', square), _defineProperty(_classnames, prefixCls + '-line', hasLine), _defineProperty(_classnames, prefixCls + '-carousel', isCarousel), _classnames));\n      return React.createElement('div', {\n        className: cls\n      }, renderEl);\n    }\n  }]);\n\n  return Grid;\n}(React.Component);\n\nexport default Grid;\nGrid.defaultProps = {\n  data: [],\n  hasLine: true,\n  isCarousel: false,\n  columnNum: 4,\n  carouselMaxRow: 2,\n  prefixCls: 'am-grid',\n  square: true,\n  itemStyle: {}\n};","map":null,"metadata":{},"sourceType":"module"}